var temporary_attendee_expire_time,csrf_token,previousSessions=[],temp_user_id="user_exists";function onLoadPluginSession(){csrf_token=$("input[name=csrfmiddlewaretoken]").val(),temporary_attendee_expire_time=$(".temporary_attendee_expire_time").val(),$(".form-plugin-multiple-registration").length>0&&(economy_data.multiple.is_multiple=!0),$("body").find(".form-plugin-session-radio-button").each(function(){var e=$(this),s=e.attr("id");previousSessions[s]=[],e.find(".form-plugin-item").find("td:first").find("input").each(function(){if($(this).prop("checked")){var e=$(this).attr("data-session-id").split("_")[0];-1==$.inArray(e,previousSessions[s])&&previousSessions[s].push(e)}})})}function getSessionAgenda(e){var s=e.find(".session-agenda-date-range").attr("data-date-range"),t=e.find(".session-agenda-table").data("all-date");if(-1!==jQuery.inArray(s,t))sessionAgendaFilter(e);else{var a=$("input[name=csrfmiddlewaretoken]").val(),i=e.find(".agenda_settings_options").val(),o={page_id:e.find(".page_id").val(),box_id:e.find(".box_id").val(),element_id:e.attr("data-id"),date_range:s,settings:i,csrfmiddlewaretoken:a};$(".loader").show(),$.ajax({url:base_url+"/get-session-agenda-filtered-data/",type:"POST",data:o,success:function(a){a.success&&(t.push(s),e.find(".session-agenda-table").attr("data-all-date",t),e.find(".session-agenda-table").find("tbody").append(a.session_agenda_list),sessionAgendaFilter(e),$(".loader").hide())}})}}function getSessionAgendaReload(e){var s=e.find(".session-agenda-date-range").attr("data-date-range"),t=e.find(".session-agenda-table").data("all-date");t=jQuery.grep(t,function(e){return e!=s});var a=$("input[name=csrfmiddlewaretoken]").val(),i=e.find(".agenda_settings_options").val(),o={page_id:e.find(".page_id").val(),box_id:e.find(".box_id").val(),element_id:e.attr("data-id"),date_range:s,settings:i,csrfmiddlewaretoken:a};$(".loader").show(),$.ajax({url:base_url+"/get-session-agenda-filtered-data/",type:"POST",data:o,success:function(a){if(a.success){t.push(s);var i='[data-start="'+s+'"]';e.find(".session-agenda-table").find("tbody tr").filter(i).remove(),e.find(".session-agenda-table").attr("data-all-date",t),e.find(".session-agenda-table").find("tbody").append(a.session_agenda_list),sessionAgendaFilter(e),$(".loader").hide()}}})}function onLoadDateJs(){$body.find(".form-plugin-session-agenda").each(function(){var e=$(this).find(".agenda_settings_options").val(),s=JSON.parse(e),t=s.session_agenda_date_range_start,a=s.session_agenda_date_range_end,i=t.split("-"),o=new Date(i[0],i[1]-1,i[2]),n=a.split("-"),d=new Date(n[0],n[1]-1,n[2]);$(this).find(".session-agenda-date-picker").pickadate({min:o,max:d,onSet:function(e){var s=this.get(),t=moment(s).format("MM/DD/YYYY"),a=this.$node.closest(".form-plugin-session-agenda");a.find(".session-agenda-date-range").attr("data-date-range",t),getSessionAgenda(a)}})})}function getDateWithLanguage(e,s){var t=global_getDateWithLanguage(e);s.pickadate("picker").set("select",$.trim(t))}function sessionAgendaFilter(e){e.find(".form-plugin-table tbody tr").hide();var s="",t=e.find(".page-search-session-agenda").val();null!=t&&(s=$.trim(t));var a=e.find(".session-agenda-date-range").attr("data-date-range"),i=$.map(e.find(".session-agenda-group-toggle-list-item").find('input[type="checkbox"]:checked'),function(e){return parseInt($(e).val())}),o=!1;e.find(".session-agenda-my-session-toggle").is(":checked")&&(o=!0);var n=e.find(".form-plugin-table tbody tr");if(o&&(n=e.find(".form-plugin-table tbody tr.attending")),e.find(".session-agenda-group-toggle-list").length>0)for(var d=0;d<i.length;d++)n.each(function(){var e=!1,t=$(this),o="session-group-"+i[d];t.attr("data-start")==a&&t.hasClass(o)&&(""!=s?t.find(".session-agenda-searchable-property").each(function(){-1!=$(this).text().toUpperCase().indexOf(s.toUpperCase())&&(e=!0)}):e=!0),e&&t.show()});else n.each(function(){var e=!1,t=$(this);t.attr("data-start")==a&&(""!=s?t.find(".session-agenda-searchable-property").each(function(){-1!=$(this).text().toUpperCase().indexOf(s.toUpperCase())&&(e=!0)}):e=!0),e&&t.show()});0==e.find(".form-plugin-table tbody tr:visible").length?e.find(".empty-session-agenda-table").show():e.find(".empty-session-agenda-table").hide()}function validateMaxSessionCheckbox(e,s){var t=!0;return s&&e.closest(".form-plugin-session-checkbox:visible").each(function(){var e=$(this).find(".form-plugin-list").attr("data-session-choose-highest");console.log(e),"up-to-max-available-sessions"==e&&(e=10);var s=$(this),a=!0,i=s.find(".form-plugin-list").attr("data-count-attending");console.log(i),"0"==i&&(a=!1);var o=[];console.log(a),s.find(".form-plugin-item").find("td:first").find("input[type=checkbox]").each(function(){var e=!1;if(a?e=$(this).prop("checked"):($(this).closest("tr").hasClass("attending")||$(this).closest("tr").hasClass("in-queue"))&&(e=!0,console.log("is_checked"),console.log(e),console.log($(this).attr("data-session-id"))),e){var s=$(this).attr("data-session-id");o.push(s)}}),console.log(o.length),0!=e&&o.length>e&&(t=!1,s.addClass("validation-failed"))}),console.log(t),t}function get_temp_user_id(e,s){var t="radio"==s?".form-plugin-session-radio-button":".form-plugin-session-checkbox",a=e.closest(".section").find(".temporary-user-id-for-reg").val(),i=e.closest(t).attr("data-uid");return null!=i?a=i:null==a?(e.closest(".section").append('<input class="temporary-user-id-for-reg" type="hidden" value="">'),a="new"):""==a&&(a="new"),a}function setOrUnsetSession(){var e=[],s=[];if($body.find(".form-plugin-session-radio-button:hidden").each(function(){var s=$(this);s.find("input[type=radio]:checked").each(function(){var t=$(this).attr("data-session-id").split("_"),a=t[0];if(t.length>1)var i=t[1].split("u")[1];else i="new";var o={attendee_id:i,session_id:a,box_selector:$(this).attr("id"),seats_option:$(this).closest(".form-plugin-list").attr("data-seats-option"),rebates:JSON.stringify(rebate_for_session(s,a)),order_number:economy_data.multiple.order_number,type:"radio"};e.push(o)})}),console.log($body.find(".form-plugin-session-checkbox:hidden").length),$body.find(".form-plugin-session-checkbox:hidden").each(function(){var s=$(this);console.log("$element.find('input[type=checkbox]:checked').length"),console.log(s.find("input[type=checkbox]:checked").length),s.find("input[type=checkbox]").each(function(){if(console.log($(this).is(":checked")),$(this).is(":checked")){var t=$(this).attr("data-session-id").split("_"),a=t[0];if(t.length>1)var i=t[1].split("u")[1];else i="new";var o={attendee_id:i,session_id:a,box_selector:$(this).attr("id"),seats_option:$(this).closest(".form-plugin-list").attr("data-seats-option"),rebates:JSON.stringify(rebate_for_session(s,a)),order_number:economy_data.multiple.order_number,type:"checkbox"};e.push(o)}else unchecked_box_elms.remove($(this).attr("id"))})}),$body.find(".form-plugin-session-radio-button:visible").each(function(){if(console.log($(this).attr("id")),$(this).find("input[type=radio]:checked").length<1){var e=$(this).attr("preselected_session");if(console.log(e),""!=e){var t=$(this).attr("id").split("-"),a=$(this).attr("data-uid");if(null==a&&(a="new"),"new"!=a)var i="temporary-radio-"+t[3]+"-id-"+e+"-u"+a;else i="temporary-radio-"+t[3]+"-id-"+e+"-u";var o={attendee_id:a,session_id:e,box_selector:i,seats_option:$(this).find(".form-plugin-list").attr("data-seats-option"),rebates:JSON.stringify(rebate_for_session($(this),e)),order_number:economy_data.multiple.order_number,type:"radio"};s.push(o)}}}),$body.find(".form-plugin-session-checkbox:visible").each(function(){if($(this).find("input[type=checkbox]:checked").length<1){var e=$(this).attr("preselected_session");if(""!=e){e=JSON.parse(e);var t=$(this).attr("id").split("-"),a=$(this).attr("data-uid");null==a&&(a="new");for(var i=0;i<e.length;i++){if("new"!=a)var o="temporary-checkbox-"+t[3]+"-id-"+e[i]+"-u"+a;else o="temporary-checkbox-"+t[3]+"-id-"+e[i]+"-u";if(-1==unchecked_box_elms.indexOf(o)){var n=$(this).find(".form-plugin-list").attr("data-seats-option"),d={attendee_id:a,session_id:e[i],box_selector:o,seats_option:n,rebates:JSON.stringify(rebate_for_session($(this),e[i])),order_number:economy_data.multiple.order_number,type:"checkbox"};s.push(d)}}}}}),console.log(unchecked_box_elms),console.log("unset_sessions"),console.log(e),console.log("set_sessions"),console.log(s),e.length>0||s.length>0){var t={unset_sessions:JSON.stringify(e),set_sessions:JSON.stringify(s),csrfmiddlewaretoken:csrf_token};$.ajax({url:base_url+"/session-set-unset-availability/",type:"POST",data:t,async:!1,success:function(e){for(var s=e.unset_session_response,t=e.set_session_response,a=0;a<s.length;a++){var i=s[a];if(i.success){var o=$("#"+i.box_selector);o.closest("tr").removeClass("not-attending not-answerd attending in-queue"),o.removeClass("not-attending not-answerd attending in-queue"),o.prop("checked",!1);var n=o.closest("tr").find(".status");"not-attending"==i.status&&(o.closest("tr").addClass(i.status),n.addClass(i.status),n.html(i.status_msg)),economy_remove_item_from_economy(o,"session",i.session_id),"new"==i.temp_user_id&&(o.closest(".section").find(".temporary-user-id-for-reg").val(i.temp_user_id),temp_user_id=i.temp_user_id,attendee_timeout_worker(i.temp_user_id,o.closest(".section"))),null!=i.seats_availability&&o.closest("tr").find(".form-plugin-table").find(".seats-available").find(".available-seats").html(i.seats_availability)}}for(var d=0;d<t.length;d++){var l=t[d];if(l.success){var r=$("#"+l.box_selector);r.closest("tr").removeClass("not-attending not-answerd attending in-queue"),r.removeClass("not-attending not-answerd attending in-queue");var c=r.closest("tr").find(".status");l.result?(r.prop("checked",!0),r.closest("tr").addClass(l.status),c.addClass(l.status),c.html(l.status_msg),"attending"==l.status&&(economy_add_to_order(r,"session",l.session_id),economy_data.multiple.is_multiple&&null!=l.order_number&&"None"!=l.order_number&&(economy_data.multiple.order_number=l.order_number)),"radio"==l.type?(previousSessions[r.closest(".form-plugin-session-radio-button").attr("id")][0]=l.session_id,r.trigger("click")):r.trigger("change")):"not-attending"==l.status&&(r.closest("tr").addClass(l.status),c.addClass(l.status),c.html(l.status_msg)),"new"==l.temp_user_id&&(r.closest(".section").find(".temporary-user-id-for-reg").val(l.temp_user_id),temp_user_id=l.temp_user_id,attendee_timeout_worker(l.temp_user_id,r.closest(".section"))),null!=l.seats_availability&&r.closest("tr").find(".form-plugin-table").find(".seats-available").find(".available-seats").html(l.seats_availability)}}}})}}unchecked_box_elms=[],$(function(){var e=$("body");e.on("change",'.session-agenda-group-toggle-list-item input[type="checkbox"]',function(e){sessionAgendaFilter($(this).closest(".form-plugin-session-agenda"))}),e.on("change",".session-agenda-my-session-toggle",function(e){sessionAgendaFilter($(this).closest(".form-plugin-session-agenda"))}),e.on("keyup",".page-search-session-agenda",function(e){sessionAgendaFilter($(this).closest(".form-plugin-session-agenda"))}),e.on("click",".session-agenda-today",function(e){var s=new Date;moment(s).format("MM/DD/YYYY");getDateWithLanguage(moment(s).format("YYYY-MM-DD"),$(this).closest(".session-agenda-date").find(".session-agenda-date-picker"))}),e.on("click",".session-agenda-prev",function(e){var s=$(this).closest(".form-plugin-session-agenda").find(".session-agenda-date-range").attr("data-date-range").split("/"),t=new Date(s[2],s[0]-1,s[1]-1);moment(t).format("MM/DD/YYYY");getDateWithLanguage(moment(t).format("YYYY-MM-DD"),$(this).closest(".session-agenda-date").find(".session-agenda-date-picker"))}),e.on("click",".session-agenda-next",function(e){var s=$(this).closest(".form-plugin-session-agenda").find(".session-agenda-date-range").attr("data-date-range").split("/"),t=new Date(s[2],s[0]-1,parseInt(s[1])+1);moment(t).format("MM/DD/YYYY");getDateWithLanguage(moment(t).format("YYYY-MM-DD"),$(this).closest(".session-agenda-date").find(".session-agenda-date-picker"))});var s="";$("body").on("click",".session",function(e){var t=$(this).data("id"),a=$.trim($(this).attr("data-box-id"));s=$(this).closest(".form-plugin").attr("id");var i=$.trim($(this).attr("data-page-id")),o=$(this).closest(".form-plugin").attr("data-name"),n=$("input[name=csrfmiddlewaretoken]").val();$.ajax({url:base_url+"/get-scheduler-session-details/",type:"POST",data:{box_id:a,page_id:i,session_id:t,plugin_name:o,csrfmiddlewaretoken:n},success:function(e){e.success&&($("#dialoge").html(e.session_html),$("#dialoge").removeClass("_visible").addClass("visible"))}})}),$("body").on("change","#attende-or-cancel-session input[type=checkbox]",function(e){e.preventDefault(),e.stopPropagation(),$(".loader").show();var t=$(this),a=$(this),i=$(this).attr("data-session-id"),o=$(this).attr("data-status"),n="unchecked";"not-attending"==o?n="checked":"attending"==o?n="unchecked":"in-queue"==o?n="unchecked":"deciding"==o&&(n="unchecked");var d=$("#"+s).closest(".form-plugin").attr("data-name"),l=$("#"+s).closest(".form-plugin").attr("data-uid");if("session-agenda"==d)var r=$("#"+s).find(".agenda_settings_options").val(),c=JSON.parse(r).session_agenda_session_available;else r=$("#"+s).find(".scheduler_settings_options").val(),c=JSON.parse(r).session_scheduler_session_available;var u=$("input[name=csrfmiddlewaretoken]").val(),p={operation:n,session_id:i,seats_option:c,temp_user_id:l,rebates:JSON.stringify([]),csrfmiddlewaretoken:u};t.prop("disabled",!0),$.ajax({url:base_url+"/check-session-availability/",type:"POST",data:p,success:function(e){if(console.log(e),$(".loader").hide(),t.prop("disabled",!1),e.success)if($("#attende-or-cancel-session").closest(".switch-wrapper").find(".session-slider-label").html(e.status_msg),"full-queue-open"==e.status?(a.attr("data-status","not-attending"),$("#attende-or-cancel-session").closest(".session-details").find(".status").find("em").html(e.status_queue_open_msg)):(a.attr("data-status",e.status),$("#attende-or-cancel-session").closest(".session-details").find(".status").find("em").html(e.status_msg)),null!=e.seats_availability&&$("#attende-or-cancel-session").closest(".session-details").find(".form-plugin-table").find(".seats-available").find(".available-seats").html(e.seats_availability),$.growl.notice({message:e.message}),"session-scheduler"==d){var i=scheduler.data("kendoScheduler");i.dataSource.read(),i.view(i.view().name)}else if("session-agenda"==d){getSessionAgendaReload($("#"+s).closest(".form-plugin-session-agenda"))}}})})}),$(document).ready(function(){function e(e,s,t){$("#dialoge .dialoge-menu").append("<li data-section='"+s+"'><a>"+e+"</a><span class='dialoge-menu-close-button'></span></li>"),$("#dialoge .dialogue-content").append("<div class='section "+s+"'>"+t+"</div>"),$("#dialoge .dialogue-content .section").not("."+s).hide(),$("#dialoge .dialoge-menu li").removeClass("active"),$("#dialoge .dialoge-menu [data-section='"+s+"']").addClass("active"),$("#dialoge .dialoge-menu").animate({scrollLeft:$("#dialoge .dialoge-menu").width()},250)}$("body").on("click","#dialoge .dialoge-menu a",function(){var e=$(this).parent("li").attr("data-section");$("#dialoge .dialoge-menu li").removeClass("active"),$(this).parent("li").addClass("active"),$("#dialoge .section").hide(),$("#dialoge .section."+e).show()}),$("body").on("click",".dialoge-menu-close-button",function(e){e.stopPropagation();var s=$(this).parent("li").attr("data-section");if($("."+s).remove(),$(this).parent("li").remove(),$("#dialoge .dialoge-menu").has("li").length)if($("#dialoge .dialoge-menu li").hasClass("active")){t=$("#dialoge .dialoge-menu .active").attr("data-section");$("#dialoge .section").hide(),$("#dialoge .section."+t).show()}else{$("#dialoge .dialoge-menu").find("li").first().addClass("active");var t=$("#dialoge .dialoge-menu .active").attr("data-section");$("#dialoge .section").hide(),$("#dialoge .section."+t).show()}else $("#dialoge *").empty(),$("#dialoge").removeClass("visible")}),$("#dialoge .dialoge-button-row").on("click",".close-button",function(){var e=$("#dialoge .dialoge-menu .active").attr("data-section");$("."+e).remove(),$("#dialoge .dialoge-menu .active").remove(),$("#dialoge .dialoge-menu").find("li").first().addClass("active");var s=$("#dialoge .dialoge-menu .active").attr("data-section");$("#dialoge .section."+s).show(),$("#dialoge .dialoge-menu").has("li").length||($("#dialoge *").empty(),$("#dialoge").removeClass("visible"))}),$("body").on("click",".close-dialouge",function(){$("#dialoge *").empty(),$("#dialoge").removeClass("visible")});var s=0;$("body").on("click",".location .location-details",function(t){var a=$(this);$(".submit-loader").show();var i=a.attr("href");a.attr("href","javascript:void(0)"),a.prop("disabled",!0);try{t.preventDefault(),t.stopPropagation();var o=$("input[name=csrfmiddlewaretoken]").val(),n=$.trim($(this).attr("data-box-id")),d=$.trim($(this).attr("data-page-id")),l=$.trim($(this).attr("data-location-id"));$.ajax({url:base_url+"/get-location-details/"+parseInt(l)+"/",type:"POST",data:{box_id:n,page_id:d,csrfmiddlewaretoken:o},success:function(t){if($("#dialoge").hasClass("visible"))e(t.lang_details,"test-tab"+s,t.details),s+=1;else{$("#dialoge").html("<div class='dialogue-content'><ul class='dialoge-menu'></ul><div class='close-dialouge'></div></div>"),$("#dialoge").removeClass("_visible").addClass("visible"),e(t.lang_details,"test-tab"+s,t.details),s+=1}$(".submit-loader").hide(),a.prop("disabled",!1),a.attr("href",i)}})}catch(e){console.log(e),$(".submit-loader").hide(),a.prop("disabled",!1),a.attr("href",i)}}),$("body").on("click",".speaker .attendee-details",function(t){var a=$(this);$(".submit-loader").show();var i=a.attr("href");a.attr("href","javascript:void(0)"),a.prop("disabled",!0);try{t.preventDefault(),t.stopPropagation();var o=$("input[name=csrfmiddlewaretoken]").val(),n=$.trim($(this).attr("data-box-id")),d=$.trim($(this).attr("data-page-id")),l=$.trim($(this).attr("data-attendee-id"));$.ajax({url:base_url+"/get-attendee-details/"+parseInt(l)+"/",type:"POST",data:{box_id:n,page_id:d,csrfmiddlewaretoken:o},success:function(t){if($("#dialoge").hasClass("visible"))e(t.lang_details,"test-tab"+s,t.details),s+=1;else{$("#dialoge").html("<div class='dialogue-content'><ul class='dialoge-menu'></ul><div class='close-dialouge'></div></div>"),$("#dialoge").removeClass("_visible").addClass("visible"),e(t.lang_details,"test-tab"+s,t.details),s+=1}$(".submit-loader").hide(),a.prop("disabled",!1),a.attr("href",i)}})}catch(e){console.log(e),$(".submit-loader").hide(),a.prop("disabled",!1),a.attr("href",i)}})}),$(function(){function e(e,s){setTimeout(function(){$.ajax({url:base_url+"/delete-temporary-attendee/",type:"POST",data:{id:e,csrfmiddlewaretoken:csrf_token},success:function(e){e.result?(s.find(".temporary-user-id-for-reg").val(""),s.find(".form-plugin-session-checkbox").each(function(){$(this).find("input:checkbox").each(function(){console.log($(this).is(":checked")),$(this).is(":checked")&&$(this).prop("checked",!1)})}),s.find(".form-plugin-session-radio-button").each(function(){$(this).find("input:radio").each(function(){console.log($(this).is(":checked")),$(this).is(":checked")&&$(this).prop("checked",!1)})}),console.log(e.message),$.growl.warning({message:e.message}),cleanEconomyData(s)):console.log(e.message)}})},temporary_attendee_expire_time)}$("body").on("click",".session-check-availability",function(s){var t,a=$(this);if(a.hasClass("disabled"))return!1;if(!validateMaxSessionCheckbox(a,s.currentTarget.checked))return $(".validation-failed:visible:first").length>0&&$("html, body").animate({scrollTop:$(".validation-failed:visible:first").offset().top},300),!1;a.closest(".form-plugin-session-checkbox").removeClass("validation-failed");var i=a.closest(".form-plugin-list").attr("data-seats-option"),o=a.closest("tr").find(".status");temp_user_id=get_temp_user_id(a,"checkbox");var n=a.attr("data-session-id").split("_")[0],d=!1;s.currentTarget.checked?(unchecked_box_elms.remove(a.attr("id")),t={operation:"checked",session_id:n,seats_option:i,temp_user_id:temp_user_id,rebates:JSON.stringify(rebate_for_session($(this),n)),order_number:economy_data.multiple.order_number,csrfmiddlewaretoken:csrf_token}):(unchecked_box_elms.push(a.attr("id")),d=!0,t={operation:"unchecked",session_id:n,seats_option:i,temp_user_id:temp_user_id,csrfmiddlewaretoken:csrf_token}),$.ajax({url:base_url+"/check-session-availability/",type:"POST",data:t,async:!1,success:function(t){t.success&&(a.closest("tr").removeClass("not-attending not-answerd attending in-queue"),o.removeClass("not-attending not-answerd attending in-queue"),t.result?(null!=s.originalEvent&&$.growl.notice({message:t.message}),a.closest("tr").addClass(t.status),o.addClass(t.status),o.html(t.status_msg),"attending"==t.status&&(economy_add_to_order(a,"session",n),economy_data.multiple.is_multiple&&null!=t.order_number&&"None"!=t.order_number&&(economy_data.multiple.order_number=t.order_number))):(null!=s.originalEvent&&$.growl.warning({message:t.message}),a.prop("checked",!1),"not-attending"==t.status&&(a.closest("tr").addClass(t.status),o.addClass(t.status),o.html(t.status_msg)),d&&(economy_remove_item_from_economy(a,"session",n),t.download_flag&&(window.location=base_url+"/economy-pdf-request?uid="+t.user_id+"&data=credit-invoice&order_number="+t.order_number))),"new"==temp_user_id&&(a.closest(".section").find(".temporary-user-id-for-reg").val(t.temp_user_id),temp_user_id=t.temp_user_id,e(t.temp_user_id,a.closest(".section"))),null!=t.seats_availability&&a.closest("tr").find(".form-plugin-table").find(".seats-available").find(".available-seats").html(t.seats_availability))}})}),$("body").on("change",".session-radio-availability",function(s){var t=$(this),a=t.closest(".form-plugin-session-radio-button").attr("id"),i=0;previousSessions[a].length>0&&(i=previousSessions[a][0]);var o=t.closest(".form-plugin-list").attr("data-seats-option"),n=t.closest("tr").find(".status");temp_user_id=get_temp_user_id(t,"radio");var d=t.attr("data-session-id").split("_")[0];d=d.trim(),$.ajax({url:base_url+"/check-session-availability/",type:"POST",data:{operation:"radio",session_id:d,previous_id:i,seats_option:o,temp_user_id:temp_user_id,rebates:JSON.stringify(rebate_for_session($(this),d)),order_number:economy_data.multiple.order_number,csrfmiddlewaretoken:csrf_token},async:!1,success:function(o){if(o.success){if(t.closest("tr").removeClass("not-attending not-answerd attending in-queue"),n.removeClass("not-attending not-answerd attending in-queue"),o.result){if(null!=s.originalEvent&&$.growl.notice({message:o.message}),t.closest("tr").addClass(o.status),n.addClass(o.status),"attending"==o.status){if(0!=i){var l=t.attr("data-session-id").split("_")[1],r=a.split("-")[3],c=$("#temporary-radio-"+r+"-id-"+i+"-"+l);c.closest("tr").removeClass("not-attending not-answerd attending in-queue"),c.closest("tr").find(".status").removeClass("not-attending not-answerd attending in-queue"),c.closest("tr").addClass("not-attending"),c.closest("tr").find(".status").addClass("not-attending")}previousSessions[a][0]=d}"new"==temp_user_id&&(t.closest(".section").find(".temporary-user-id-for-reg").val(o.temp_user_id),temp_user_id=o.temp_user_id,e(o.temp_user_id,t.closest(".section"))),"attending"==o.status&&(economy_add_to_order(t,"session",d),0!=i&&economy_remove_item_from_economy(t,"session",i),economy_data.multiple.is_multiple&&null!=o.order_number&&"None"!=o.order_number&&(economy_data.multiple.order_number=o.order_number))}else null!=s.originalEvent&&$.growl.warning({message:o.message}),t.prop("checked",!1),0!=i&&$("#temporary-radio-"+a.split("-")[1]+"-id-"+i).prop("checked",!0);null!=o.seats_availability&&t.closest("tr").find(".form-plugin-table").find(".seats-available").find(".available-seats").html(o.seats_availability),null!=o.previous_session_seats_availability&&($("#temporary-radio-"+a.split("-")[1]+"-id-"+i).closest("tr").find(".form-plugin-table").find(".seats-available").find(".available-seats").html(o.previous_session_seats_availability),o.previous_session_seats_availability>0&&$("#temporary-radio-"+a.split("-")[1]+"-id-"+i).prop("disabled")&&$("#temporary-radio-"+a.split("-")[1]+"-id-"+i).prop("disabled",!1))}}})}),window.onbeforeunload=function(){0==isNaN(temp_user_id)&&$.ajax({url:base_url+"/delete-temporary-attendee/",type:"POST",data:{id:temp_user_id,csrfmiddlewaretoken:csrf_token},success:function(e){e.result,console.log(e.message)}})}}),Array.prototype.remove=function(){for(var e,s,t=arguments,a=t.length;a&&this.length;)for(e=t[--a];-1!==(s=this.indexOf(e));)this.splice(s,1);return this},$(function(){$body.on("click",".evaluation-send-button",function(e){var s=[],t=$(this);t.closest(".form-plugin-evaluations").find(".star-evaluation-group").each(function(){var e=$(this).find("input:checked").val();if("0"!=e&&0!=e&&NaN!=e&&null!=e){var t={session_id:$(this).attr("data-id"),rating:parseInt(e)};s.push(t)}});var a=$("input[name=csrfmiddlewaretoken]").val();t.closest(".form-plugin-evaluations").removeClass("validation-failed"),0!=s.length?$.ajax({url:base_url+"/set-ratings/",type:"POST",data:{sessions_rating:JSON.stringify(s),csrfmiddlewaretoken:a},success:function(e){if(e.error)t.closest(".form-plugin-evaluations").find(".error-on-validate").html(e.error);else{var a=t.closest(".form-plugin-evaluations");$.growl.notice({message:e.message});for(var i=0;i<s.length;i++)t.parent().find("#rated_session_"+s[i].session_id).closest(".form-plugin-item").remove();0==a.children(".form-plugin-list").children(".form-plugin-item").length&&(a.find(".evaluation-send-button").remove(),addEmptyDiv(a,e.empty_txt_language))}}}):t.closest(".form-plugin-evaluations").addClass("validation-failed")}),$body.on("click",".messages-hide",function(e){archivedNotification($(this))}),$body.on("click",".messages-mark-all-button",function(e){var s=$(this),t=$("input[name=csrfmiddlewaretoken]").val();s.closest(".form-plugin-messages").removeClass("validation-failed"),$.ajax({type:"Post",url:base_url+"/archive-all-messages/",data:{csrfmiddlewaretoken:t},success:function(e){if(e.error)s.closest(".form-plugin-messages").addClass("validation-failed"),s.closest(".form-plugin-messages").find(".error-on-validate").html(e.message);else{$.growl.notice({message:e.message});var t=s.closest(".form-plugin-messages");s.closest(".form-plugin-messages").find(".form-plugin-item").remove(),t.find(".messages-mark-all-button").remove(),t.find(".messages-read-archived-messages").is(":visible")||t.find(".messages-read-archived-messages").css("display","block"),addEmptyDiv(t,e.empty_txt_language)}}})}),$body.on("keyup",".page-search-location",function(e){var s=$(this),t=window.location.pathname.split("/")[2],a=(s.closest(".box").attr("data-id"),s.closest(".box").attr("id").split("-")[3]);if(null!=t&&null!=a&&""!=t&&""!=a){s.closest(".form-plugin-location-list").find(".form-plugin-item").hide();var i=$.trim($(this).val());$(".form-plugin-item").each(function(){-1!=$(this).find(".form-plugin-title").text().toUpperCase().indexOf(i.toUpperCase())&&$(this).show()})}}),$body.on("click",".verification-login-send-button",function(e){var s=$(this).closest(".form-plugin-login-form"),t=$.trim(s.find(".email-password-verification-email").val()),a=$.trim(s.find(".email-password-verification-password").val()),i=$("input[name=csrfmiddlewaretoken]").val();""!=t&&checkEmail(t)&&""!=a?$.ajax({url:base_url+"/login/",type:"POST",data:{user_email:t,user_password:a,csrfmiddlewaretoken:i},success:function(e){e.success?($.growl.notice({message:e.message}),redirectToPage(e.redirect_url)):s.addClass("validation-failed")}}):s.addClass("validation-failed")}),$body.on("click",".request-login-send-button",function(e){var s=$(this).closest(".form-plugin-request-login"),t=s.find(".request-login-email").val(),a=$("input[name=csrfmiddlewaretoken]").val(),i=$(this).attr("data-email-id");if(""!=t&&checkEmail(t)){s.removeClass("validation-failed");var o={user_email:t,csrfmiddlewaretoken:a};""!=i&&"null"!=i&&null!=i&&(o.send_email_id=i),$.ajax({url:base_url+"/retrieve-uid/",type:"POST",data:o,success:function(e){e.success?$.growl.notice({message:e.message}):($.growl.error({message:e.message}),s.addClass("validation-failed"))}})}else s.addClass("validation-failed")}),$body.on("click",".reset-password-button",function(e){var s=$(this).closest(".form-plugin-reset-password"),t=s.find(".form-plugin-reset-password-email").val(),a=$(this).attr("data-email-id"),i=$("input[name=csrfmiddlewaretoken]").val();if(""!=t&&checkEmail(t)){s.removeClass("validation-failed");var o={user_email:t,csrfmiddlewaretoken:i};""!=a&&null!=a&&null!=a&&(o.email_id=a),locaion_href=window.location.href,locaion_href.indexOf("retrieve-password")>0?$.ajax({url:site_url+"/retrieve-password/",type:"POST",data:o,success:function(e){e.success?$.growl.notice({message:e.message}):s.addClass("validation-failed")}}):$.ajax({url:base_url+"/resetpass/",type:"POST",data:o,success:function(e){e.success?$.growl.notice({message:e.message}):s.addClass("validation-failed")}})}else s.addClass("validation-failed")}),$body.on("click",".new-password-button",function(e){var s=$(this).closest(".form-plugin-new-password"),t=s.find(".form-plugin-new-password-email").val(),a=s.find(".form-plugin-repeat-new-password-email").val(),i=$("input[name=csrfmiddlewaretoken]").val();if(""==t||""==a||t!=a||t.length<6)s.addClass("validation-failed");else{s.removeClass("validation-failed");var o={new_password:t,csrfmiddlewaretoken:i};$.ajax({url:base_url+"/savepass/",type:"POST",data:o,success:function(e){e.success?($.growl.notice({message:e.message}),window.location.replace(e.location)):s.addClass("validation-failed")}})}}),$body.on("click",".upload-image",function(e){var s=$("input[name=csrfmiddlewaretoken]").val(),t=$(this);try{t.closest(".form-plugin-photo-upload").removeClass("validation-failed");var a=$("input[name=pic]")[0].files[0];if(null!=a){var i=new FormData,o=t.closest(".form-plugin-photo-upload").find("textarea[name=comment]").val();$(".submit-loader").show(),t.prop("disabled",!0),i.append("pic",a),null!=o&&i.append("comment",o);var n=t.closest(".form-plugin-photo-upload").attr("id").split("-")[1],d=t.closest(".form-plugin-photo-upload").attr("id").split("-")[3],l=t.closest(".form-plugin-photo-upload").attr("data-photo-group-id");i.append("page_id",n),i.append("box_id",d),i.append("photo_group_id",l),i.append("csrfmiddlewaretoken",s),$.ajax({url:base_url+"/upload-files/",type:"POST",data:i,contentType:!1,processData:!1,success:function(e){$(".submit-loader").hide(),t.prop("disabled",!1),e.success?($.growl.notice({message:e.message}),t.closest(".form-plugin-photo-upload").find("input[name=pic]").val(""),t.closest(".form-plugin-photo-upload").find(".selected-file").css("display","none"),t.closest(".form-plugin-photo-upload").find("textarea[name=comment]").val("")):(t.closest(".form-plugin-photo-upload").find(".error-on-validate").html(e.message),t.closest(".form-plugin-photo-upload").addClass("validation-failed"))}})}else t.closest(".form-plugin-photo-upload").addClass("validation-failed")}catch(e){$(".submit-loader").hide(),t.prop("disabled",!1),t.closest(".form-plugin-photo-upload").addClass("validation-failed")}}),$("body").on("click",".click-notification",function(e){var s=$(this),t={id:$(this).attr("data-id"),action:$(this).attr("data-value"),csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()};$.ajax({url:base_url+"/notification-session/",type:"POST",data:t,success:function(e){e.success&&s.closest("li").remove(),e.download_flag&&(window.location=base_url+"/economy-pdf-request?data=credit-invoice&order_number="+e.order_number),$.growl.notice({message:e.message})}})}),$body.on("change",'input[name="pic"]',function(){var e=$(this).val().split("\\").pop();$(this).closest(".form-plugin-photo-upload").find(".file-fake-path").html(e),$(this).closest(".form-plugin-photo-upload").find(".selected-file").css("display","block")}),$("body").on("click",".form-pdf-button",function(e){var s=$(this).closest(".form-plugin-pdf-button").attr("id").split("-")[1],t=$(this).closest(".form-plugin-pdf-button").attr("id").split("-")[3];window.location=base_url+"/convert-html-to-pdf/?page_id="+s+"&box_id="+t})});